# ูุธุงู ุงูุชุญุฏูุซ ุงูุชููุงุฆู ููุงุนุฏุฉ ุงูุจูุงูุงุช

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅูุดุงุก ูุธุงู ุชุญุฏูุซ ุชููุงุฆู ููุงุนุฏุฉ ุงูุจูุงูุงุช ูุนูู ุนูุฏ ุจุฏุก ุชุดุบูู ุงูุชุทุจูู. ูุฐุง ุงููุธุงู ูููู ุจู:

1. **ุฅูุดุงุก ุงูุฌุฏุงูู ุงูููููุฏุฉ** - ูุชุญูู ูู ูุฌูุฏ ุฌููุน ุงูุฌุฏุงูู ุงููุทููุจุฉ ูููุดุฆูุง ุฅุฐุง ูู ุชูู ููุฌูุฏุฉ
2. **ุฅุถุงูุฉ ุงูุฃุนูุฏุฉ ุงููุงูุตุฉ** - ูุถูู ุฃู ุฃุนูุฏุฉ ุฌุฏูุฏุฉ ุชู ุชุนุฑูููุง ูู Models ููู ุชูู ููุฌูุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
3. **ุชุญุฏูุซ ุงูุจููุฉ ุงูุชููุงุฆู** - ูุญุฏุซ ุจููุฉ ุงูุฌุฏุงูู ุญุณุจ ุงุญุชูุงุฌุงุช ุงูุตูุญุงุช ูุงูู Models

## ุงููููุงุช ุงูุฑุฆูุณูุฉ

### `app/db_manager.py`
ูุญุชูู ุนูู ุฌููุน ุฏูุงู ุฅุฏุงุฑุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช:

- `get_table_columns(table_name)` - ุงูุญุตูู ุนูู ุฃุณูุงุก ุงูุฃุนูุฏุฉ ุงูููุฌูุฏุฉ
- `add_column_if_not_exists(table_name, column_name, column_type)` - ุฅุถุงูุฉ ุนููุฏ ุฅุฐุง ูู ููู ููุฌูุฏุงู
- `update_database_schema()` - ุชุญุฏูุซ ุจููุฉ ุฌููุน ุงูุฌุฏุงูู
- `create_missing_tables()` - ุฅูุดุงุก ุงูุฌุฏุงูู ุงูููููุฏุฉ
- `auto_migrate_database()` - ุงูุฏุงูุฉ ุงูุฑุฆูุณูุฉ ุงูุชู ุชุณุชุฏุนู ุนูุฏ ุจุฏุก ุงูุชุทุจูู

### `app/__init__.py`
ูุณุชุฏุนู ูุธุงู ุงูุชุญุฏูุซ ุงูุชููุงุฆู ุนูุฏ ุฅูุดุงุก ุงูุชุทุจูู:

```python
with app.app_context():
    from app.db_manager import auto_migrate_database
    auto_migrate_database()
```

## ููููุฉ ุฅุถุงูุฉ ุฌุฏูู ุฃู ุนููุฏ ุฌุฏูุฏ

### 1. ุฅุถุงูุฉ ุฌุฏูู ุฌุฏูุฏ

**ุงูุฎุทูุฉ 1:** ุฃูุดุฆ Model ุฌุฏูุฏ ูู `app/models/`

```python
from app import db

class NewTable(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(128))
    created_at = db.Column(db.DateTime, default=datetime.utcnow)
```

**ุงูุฎุทูุฉ 2:** ุฃุถู ุงูุงุณุชูุฑุงุฏ ูู `app/db_manager.py` ูู ุฏุงูุฉ `create_missing_tables()`:

```python
from app.models.new_table import NewTable
```

**ุงูุฎุทูุฉ 3:** (ุงุฎุชูุงุฑู) ุฅุฐุง ููุช ุชุฑูุฏ ุฅุถุงูุฉ ุฃุนูุฏุฉ ุฅุถุงููุฉ ุนุจุฑ SQLุ ุฃุถู ูู ูุงููุณ `schema_updates`:

```python
'new_table': [
    ('column1', 'VARCHAR(64)'),
    ('column2', 'INTEGER DEFAULT 0')
]
```

**ุงูุฎุทูุฉ 4:** ุฃุนุฏ ุชุดุบูู ุงูุชุทุจูู - ุณูุชู ุฅูุดุงุก ุงูุฌุฏูู ุชููุงุฆูุงู!

### 2. ุฅุถุงูุฉ ุนููุฏ ุฌุฏูุฏ ูุฌุฏูู ููุฌูุฏ

**ุงูุฎุทูุฉ 1:** ุฃุถู ุงูุนููุฏ ูู Model:

```python
class Employee(db.Model):
    # ... ุงูุฃุนูุฏุฉ ุงูููุฌูุฏุฉ
    new_column = db.Column(db.String(64))  # ุนููุฏ ุฌุฏูุฏ
```

**ุงูุฎุทูุฉ 2:** ุฃุถู ุงูุนููุฏ ูู ูุงููุณ `schema_updates` ูู `app/db_manager.py`:

```python
'employee': [
    # ... ุงูุฃุนูุฏุฉ ุงูููุฌูุฏุฉ
    ('new_column', 'VARCHAR(64)')
]
```

**ุงูุฎุทูุฉ 3:** ุฃุนุฏ ุชุดุบูู ุงูุชุทุจูู - ุณูุชู ุฅุถุงูุฉ ุงูุนููุฏ ุชููุงุฆูุงู!

## ูุซุงู ุนูู ุงูุฅุฎุฑุงุฌ ุนูุฏ ุจุฏุก ุงูุชุทุจูู

```
============================================================
๐ Starting Database Auto-Migration...
============================================================
โ All tables created/verified

๐ Schema Updates Applied:
  โ Added username to employee
  โ Added password_hash to employee
  โ Added payment_date to payroll
  โ Added payment_method to payroll

============================================================
โ Database Migration Completed Successfully
============================================================
```

## ุงูุฌุฏุงูู ุงููุฏุนููุฉ ุญุงููุงู

- **employee** - ุจูุงูุงุช ุงูููุธููู
- **user** - ุญุณุงุจุงุช ุงููุณุชุฎุฏููู
- **payroll** - ุงูุฑูุงุชุจ
- **leave** - ุงูุฅุฌุงุฒุงุช
- **performance** - ุชูููู ุงูุฃุฏุงุก
- **attendance** - ุงูุญุถูุฑ ูุงูุงูุตุฑุงู
- **whatsapp_messages** - ุฑุณุงุฆู ูุงุชุณุงุจ
- **customer_complaint** - ุดูุงูู ุงูุนููุงุก
- **employee_presence** - ุญุงูุฉ ุชูุงุฌุฏ ุงูููุธููู
- **settings** - ุฅุนุฏุงุฏุงุช ุงููุธุงู

## ููุงุญุธุงุช ูููุฉ

1. **ุงููุณุฎ ุงูุงุญุชูุงุทู**: ูููุตุญ ุจุนูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุจู ุฅุถุงูุฉ ุชุบููุฑุงุช ูุจูุฑุฉ
2. **SQLite Limitations**: SQLite ูุง ูุฏุนู ุชุนุฏูู ุฃู ุญุฐู ุงูุฃุนูุฏุฉุ ููุท ุงูุฅุถุงูุฉ
3. **Production**: ูู ุจูุฆุฉ ุงูุฅูุชุงุฌุ ูููุถู ุงุณุชุฎุฏุงู Alembic migrations ููุชุญูู ุงูุฃูุถู

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงูุฎุทุฃ: "table already exists"
- ูุฐุง ุทุจูุนู ุฅุฐุง ูุงู ุงูุฌุฏูู ููุฌูุฏ ูุณุจูุงู
- ุงููุธุงู ูุชุฌุงูู ูุฐุง ุงูุฎุทุฃ ุชููุงุฆูุงู

### ุงูุฎุทุฃ: "duplicate column name"
- ุงูุนููุฏ ููุฌูุฏ ุจุงููุนู
- ุงููุธุงู ูุชุญูู ูุจู ุงูุฅุถุงูุฉ ูุชุฌูุจ ูุฐุง

### ุงูุฎุทุฃ: "cannot import name..."
- ุชุฃูุฏ ูู ุฃู ุงุณู ุงูููุงุณ ูู Model ูุทุงุจู ุงูุงุณู ูู ุงูุงุณุชูุฑุงุฏ
- ุชุฃูุฏ ูู ูุฌูุฏ ุงูููู ูู ุงููุณุงุฑ ุงูุตุญูุญ

## ุงููููุฒุงุช

โ **ุชููุงุฆู ุจุงููุงูู** - ูุง ุญุงุฌุฉ ูุชุดุบูู ุณูุฑูุจุชุงุช ูุฏููุงู
โ **ุขูู** - ูุชุญูู ูุจู ุฅุถุงูุฉ ุฃู ุดูุก
โ **ุณุฑูุน** - ูุนูู ููุท ุนูุฏ ุจุฏุก ุงูุชุทุจูู
โ **ูุงุถุญ** - ูุนุฑุถ log ููุตู ููู ุนูููุฉ
โ **ูุฑู** - ุณูู ุงูุฅุถุงูุฉ ูุงูุชุนุฏูู

## ุงูุชุฑููุงุช ุงููุณุชูุจููุฉ

- [ ] ุฏุนู ุชุนุฏูู ููุน ุงูุนููุฏ
- [ ] ุฏุนู ุญุฐู ุงูุฃุนูุฏุฉ (ูุน ุชุญุฐูุฑุงุช)
- [ ] Migration history tracking
- [ ] Rollback functionality
- [ ] ุฏุนู ููุงุนุฏ ุจูุงูุงุช ุฃุฎุฑู (PostgreSQL, MySQL)
